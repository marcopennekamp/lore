use lore.core.to_string
use lore.Enum.map

struct Box[+A]
  open value: A
end

trait Content
object Juice extends Content
object Berry extends Content
object Hammer extends Content

module lore.core do
  func to_string(Box[Juice]): String = 'juice box'
  func to_string(Box[Berry]): String = 'berry box'
  func to_string(thing: %{ value: Content }): String = 'thing with content'
  func to_string(thing: %{ value: Hammer }): String = 'thing with hammer'
end

// This verifies that struct types with open properties are correctly interned. Open property types should be taken
// into account.
func test(): [String] = do
  let boxes = [
    Box[Content](Juice),
    Box[Content](Berry),
    Box[Content](Hammer),
  ]
  boxes |> map(to_string)
end
