module calculator

use lore.Enum.map
use lore.Option
use lore.test._

func parse_and_evaluate(term: String): Real = term |> Tokenizer.tokenize |> Option.get_or_else([]) |> Calculator.evaluate

func main(): [Real] = [
  '',
  '1 2 +',
  '1 2 3 * +',
  '3 30 / 5 /',
  '2 3 * 4 0 - - 9 + 7 5 * /',
] |> map(parse_and_evaluate)

@bench
spec '`calculator` parses and evaluates terms to the correct result' do
  main() should_eq [0.0, 3.0, 7.0, 0.5, -35.0]
end
