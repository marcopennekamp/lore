module features.assembly.nested_lambda

use lore.Enum.map

func get_numbers(): [Int] = do
  let factor1 = 5
  let factor2 = 2
  [0, -2, 2, 6, 22] |> map(x => do
    let foo: (Int, Int) => Int = (a, b) => a * b * factor1
    foo(x, factor2)
  end)
end

@root
module features.assembly do
  use lore.test._

  // This test verifies that nested lambdas with captured variables are correctly assembled.
  spec 'nested_lambda: nested lambdas with captured variables are correctly assembled' do
    get_numbers() should_eq [0, -20, 20, 60, 220]
  end
end
